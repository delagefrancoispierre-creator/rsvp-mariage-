<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>RSVP Mariage</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, #f7e7e7, #fffaf5);
      color: #4a3b3b;
    }
    .container {
      max-width: 520px;
      margin: 40px auto;
      background: #ffffffcc;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }
    h1 {
      font-family: 'Playfair Display', serif;
      text-align: center;
      margin-bottom: 10px;
    }
    p.subtitle {
      text-align: center;
      margin-bottom: 30px;
      font-size: 0.95rem;
    }
    label {
      display: block;
      margin-top: 18px;
      margin-bottom: 6px;
      font-weight: 500;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #d8cfcf;
      font-size: 1rem;
      box-sizing: border-box;
    }
    textarea { resize: vertical; }
    button {
      margin-top: 28px;
      background: #c9a3a3;
      color: white;
      border: none;
      font-size: 1.05rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover { background: #b28b8b; }
    .success {
      display: none;
      margin-top: 20px;
      text-align: center;
      color: #3a7c59;
      font-weight: 600;
    }
    #addresses { }
  </style>
</head>
<body>

  <div class="container" id="protected" style="display:none;">
    <h1>Mariage de Cam&FP</h1>
    <p class="subtitle">Merci de confirmer ta pr√©sence üíç</p>

    <form id="rsvpForm">
      <label>Nom et pr√©nom</label>
      <input type="text" name="nom" id="nom" required />

      <label>Pr√©sent¬∑e au mariage</label>
      <select name="presence" required>
        <option value="">‚Äî Choisir ‚Äî</option>
        <option>Oui</option>
        <option>Non</option>
      </select>

      <label>Viendras-tu seul¬∑e ou accompagn√©¬∑e ?</label>
      <select name="accompagnement" id="accompagnement" required>
        <option value="">‚Äî Choisir ‚Äî</option>
        <option value="1">Seul¬∑e</option>
        <option value="2">Accompagn√©¬∑e</option>
      </select>

      <label>Nombre total de personnes (toi inclus)</label>
      <input type="number" name="nb_personnes" min="1" value="1" required />

      <label>Pr√©f√©rence de plat</label>
      <select name="plat" required>
        <option value="">‚Äî Choisir ‚Äî</option>
        <option>V√©g√©tarien</option>
        <option>Flexitarien</option>
      </select>

      <label>Quelle musique ne veux-tu pas entendre ?</label>
      <textarea name="musique_non" rows="3"></textarea>

      <label>Quelle musique te ferait plaisir ?</label>
      <textarea name="musique_oui" rows="3"></textarea>

      <label>Aurez-vous besoin d'un logement pas loin ?</label>
      <select name="logement" required>
        <option value="">‚Äî Choisir ‚Äî</option>
        <option>Oui</option>
        <option>Non</option>
      </select>

      <button type="submit">Envoyer ma r√©ponse</button>
    </form>

    <div class="success" id="successMessage">
      Merci pour ta r√©ponse ‚ù§Ô∏è<br>
      On a h√¢te de c√©l√©brer ce moment avec toi üíï
    </div>

    <div id="addresses">
      <hr style="margin:30px 0; border:none; border-top:1px solid #e5dcdc;">
      <h2 style="font-family:'Playfair Display', serif; text-align:center; font-size:1.3rem;">Adresses utiles</h2>

      <p style="margin-top:15px; font-size:0.95rem;">
        <strong>C√©r√©monie religieuse :</strong><br>
        <a href="https://www.google.com/maps/search/?api=1&query=Temple+de+Lille+Place+du+Temple+Lille" target="_blank" style="color:#8b5e5e; text-decoration:underline;">Temple de Lille<br>Place du Temple<br>Lille</a>
      </p>

      <p style="margin-top:10px; font-size:0.95rem;">
        <strong>Lieu de f√™te :</strong><br>
        <a href="https://www.google.com/maps/search/?api=1&query=La+Cense+des+Sources+chemin+du+vieux+compt√©+1+7542+Tournai+Belgique" target="_blank" style="color:#8b5e5e; text-decoration:underline;">La Cense des Sources<br>Chemin du vieux compt√© 1<br>7542 Tournai<br>Belgique</a>
      </p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(window.location.search);
      if (params.get('qr') === 'camfp') {
        document.getElementById('protected').style.display = 'block';
      } else {
        document.body.innerHTML = '<div style="font-family:Montserrat,sans-serif; padding:40px; text-align:center;">üîí<br><br>Cette page est accessible uniquement via le QR code du mariage.</div>';
        return;
      }

      const form = document.getElementById('rsvpForm');
      const success = document.getElementById('successMessage');
      // const addresses = document.getElementById('addresses');
      const nomInput = document.getElementById('nom');

      if (!form) return;

      // üîê Bloquer une r√©ponse par personne (localStorage)
      if (localStorage.getItem('rsvp_done')) {
        success.style.display = 'block';
        form.style.display = 'none';
        return;
      }

      const scriptURL = 'https://script.google.com/macros/s/TON_URL_ICI/exec';

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        fetch(scriptURL, {
          method: 'POST',
          body: new FormData(form)
        })
        .then(() => {
          localStorage.setItem('rsvp_done', 'true');
          form.style.display = 'none';
          success.style.display = 'block';
        })
        .catch(error => alert('Erreur : ' + error.message));
      });
    });
  </script>

</body>
</html>
